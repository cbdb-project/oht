(window.webpackJsonp=window.webpackJsonp||[]).push([[7,6],{438:function(t,e,n){"use strict";n.r(e);var o={url:"https://oopus.info"},_=n(89),component=Object(_.a)(o,(function(){return(0,this._self._c)("div")}),[],!1,null,null,null);e.default=component.exports},511:function(t,e,n){"use strict";n.r(e);var o=n(515),_=n(420),c=n(418),l=n(510),r=n(516),d=n(424),h=n(183),f=n(124),y=n(181),m=n(509),v=n(437),k=n(439),x=n(20),j=(n(5),n(81),n(36),n(276),n(481)),C=n.n(j),w=n(438),O={data:function(){return{chapter_id:"",section_id:"",search_result_items:[],search_result_items_title:"",tag_counter:0,tag_id:"",single_section_id:"",section_text:"",section_context:"",content:"",content_refined:"",single_search_result_items:[],biog_subjects:[],person_id:"",person_name:"",person_name_list:[],data_type:"",data_type_id:"",data_subtype:"",data_subtype_id:"",data_type_list:[],data_subtype_list:[],content_personid:"",content_person_name:"",content_person:"",absolute:!1,opacity:.85,overlay:!1,light:!0}},methods:{put_selection_text_to_content:function(){var t="";window.getSelection?t=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),this.content=t,console.log(t),navigator.clipboard.writeText(t)},update_person_name_by_cbdb_id:function(){var t=w.default.url+"/official_hist_tagging/query_person_name_by_personid.php?person_id="+this.person_id,e=this;C.a.get(t).then((function(t){e.person_name=t.data})).catch((function(t){console.log(t)}))},update_content_name_by_cbdb_id:function(){var t=w.default.url+"/official_hist_tagging/query_person_name_by_personid.php?person_id="+this.content_personid,e=this;C.a.get(t).then((function(t){e.content_person_name=t.data})).catch((function(t){console.log(t)}))},select_biog_subject:function(){this.person_id=this.person_name.split("-")[0],this.person_name=this.person_name.split("-")[1]},select_content_person:function(){this.content_personid=this.content_person_name.split("-")[0],this.content_person_name=this.content_person_name.split("-")[1],console.log(this.content_person.split("-"))},load_subjects_in_section:function(){var t=w.default.url+"/official_hist_tagging/query_subjects_in_section.php?chapter_id="+this.chapter_id;console.log(t);var e=this;C.a.get(t).then((function(t){e.person_name_list=t.data})).catch((function(t){console.log(t)}))},remove_tag:function(t,e){if(1==confirm("Confirm to delete this record")){var n=w.default.url+"/official_hist_tagging/delete_main.php?tag_id="+e;C.a.get(n).then((function(t){document.getElementById("sbt").click()})).catch((function(t){console.log(t)}))}},add_new_tag:function(t,e,n,o){this.overlay="!overlay",this.tag_id="new",this.single_section_id=t,this.section_text=e,this.content="",this.content_refined="",this.content_personid="",this.content_person_name="",this.person_id=n,this.person_name=o;var _=w.default.url+"/official_hist_tagging/query_type_list.php",c=this;C.a.get(_).then((function(t){c.data_type_list=t.data})).catch((function(t){console.log(t)})),c.data_type="1-基本信息",c.data_type_id=1,c.data_subtype="1-姓名（[姓] [名]）",c.data_subtype_id=1,c.data_subtype_list=["1-姓名（[姓] [名]）"]},clear_search_box:function(){this.chapter_id=""},call_search_api:function(){var t=w.default.url+"/official_hist_tagging/query_main.php?chapter_id="+this.chapter_id,e=this;C.a.get(t).then((function(t){e.search_result_items=t.data,e.search_result_items_title=t.data.book_name+"/"+t.data.chapter_name})).catch((function(t){console.log(t)}))},load_section:function(t){this.overlay="!overlay";var e=w.default.url+"/official_hist_tagging/query_type_list.php",n=this;C.a.get(e).then((function(t){n.data_type_list=t.data})).catch((function(t){console.log(t)})),e=w.default.url+"/official_hist_tagging/query_tags.php?tag_id="+t,n=this,C.a.get(e).then((function(t){n.single_search_result_items=t.data,n.tag_id=t.data.tag_id,n.single_section_id=t.data.section_id,n.section_text=t.data.section_text,n.content=t.data.content,n.content_refined=t.data.content_refined,console.log(),n.person_id=t.data.biog_subject_id,n.person_name=t.data.biog_subject_name,n.data_type=t.data.type+"-"+t.data.type_chn,n.data_type_id=t.data.type,n.data_subtype=t.data.subtype+"-"+t.data.subtype_chn,n.data_subtype_id=t.data.subtype,n.data_subtype_list.push(n.data_subtype),n.content_personid=t.data.content_personid,n.content_person_name=t.data.content_person_name,n.content_person=t.data.content_personid+"-"+t.data.content_person_name})).catch((function(t){console.log(t)}))},submit_data:function(){var t="";null==this.content_person_name&&(this.content_person_name=""),null==this.content_personid&&(this.content_personid=""),""!=this.content_refined&&"null"!=this.content_refined||(this.content_refined=this.content),t="new"==this.tag_id?w.default.url+"/official_hist_tagging/add_main.php?biog_subject_id=".concat(this.person_id,"&biog_subject_name=").concat(this.person_name,"&type=").concat(this.data_type_id,"&subtype=").concat(this.data_subtype_id,"&content=").concat(this.content,"&content_refined=").concat(this.content_refined,"&section_id=").concat(this.single_section_id,"&content_personid=").concat(this.content_personid,"&content_person_name=").concat(this.content_person_name):w.default.url+"/official_hist_tagging/update_main.php?tag_id=".concat(this.tag_id,"&biog_subject_id=").concat(this.person_id,"&biog_subject_name=").concat(this.person_name,"&type=").concat(this.data_type_id,"&subtype=").concat(this.data_subtype_id,"&content=").concat(this.content,"&content_refined=").concat(this.content_refined,"&content_personid=").concat(this.content_personid,"&content_person_name=").concat(this.content_person_name),console.log("test_this.content_personid:"),console.log(this.content_personid);var e=w.default.url+"/official_hist_tagging/query_person_name_by_personid.php?person_id=",n=this,o="hasn't changed",_="hasn't changed";C.a.get(e+this.person_id).then((function(t){console.log("_this.content_personid:"),console.log(n.content_personid),console.log("_this.content_person_name"),console.log(n.content_person_name),console.log(t.data),o=t.data==n.person_name||"0"==n.person_id||""==n.person_id})).then((function(){return C.a.get(e+n.content_personid)})).then((function(e){if(_=e.data==n.content_person_name||"0"==n.content_personid||""==n.content_personid,o&&_)return console.log("check passed"),console.log(t),C.a.get(t).then((function(t){if(console.log(t.data),"new"!=n.tag_id){for(var e=parseInt(n.single_section_id)-1,o=0,_=0,c=0,l=Object.entries(n.search_result_items.sections);c<l.length;c++){var r=Object(x.a)(l[c],2),d=r[0];if(r[1].section_id==e){_=d;break}}for(var h=0,f=Object.entries(n.search_result_items.sections[_].tag_records);h<f.length;h++){var y=Object(x.a)(f[h],2),m=y[0],v=y[1];if(n.tag_id==v.tag_id){o=m;break}}console.log("start:"),console.log("original biog_subject_id:"),console.log(n.search_result_items.sections[e]),console.log("person_id:"+n.person_id),console.log("tag_index:"+o),console.log("tag_index:"+e),console.log("end")}document.getElementById("sbt").click(),n.overlay=!1}));console.log(n.person_id),console.log(n.person_name),alert("perons_id_name_check_passed: "+o+";\ncontent_personid_name_check_passed: "+_+".")}))},update_data_type:function(t){this.data_type_id=t.split("-")[0],this.data_subtype="",this.get_data_subtype_list_for_select()},update_data_subtype:function(t){this.data_subtype_id=t.split("-")[0],this.data_subtype=t},get_data_subtype_list_for_select:function(){var t=w.default.url+"/official_hist_tagging/query_subtype_list_by_typeid.php?typeid="+this.data_type_id,e=this;C.a.get(t).then((function(n){console.log(t),e.data_subtype_list=n.data,e.data_subtype=e.data_subtype_list[0],e.data_subtype_id=e.data_subtype_list[0].split("-")[0]})).catch((function(t){console.log(t)}))},test:function(t){console.log(t)}},beforeMount:function(){if(void 0!==this.$route.query.id){var t=this.$route.query.id;this.chapter_id=t,this.call_search_api()}}},S=n(89),component=Object(S.a)(O,(function(){var t=this,e=t._self._c;return e(m.a,[e(l.a,{attrs:{align:"center"}},[e(m.a,[e(l.a,{attrs:{align:"left",justify:"left"}},[e(_.a,[e(c.b,{staticClass:"headline"},[e("div",{staticClass:"text-center"},[e(k.a,{attrs:{label:"Chapter ID"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.call_search_api.apply(null,arguments)}},model:{value:t.chapter_id,callback:function(e){t.chapter_id=e},expression:"chapter_id"}}),t._v(" "),e(o.a,{staticClass:"mr-4",attrs:{id:"sbt"},on:{click:t.call_search_api}},[t._v("\n         Search\n       ")]),t._v(" "),e(o.a,{staticClass:"mr-4",on:{click:t.clear_search_box}},[t._v("\n         Clear\n       ")])],1),e("br")]),t._v(" "),e("h4",[e("p",{staticStyle:{"margin-left":"15px","margin-right":"15px"}},[t._v(t._s(t.search_result_items_title))])]),t._v(" "),e(c.a,[e(h.a,t._l(t.search_result_items.sections,(function(section){return e(f.a,{key:section.section_id},[e("div",[e(c.b,{staticClass:"headline"},[t._v(t._s(section.section_text))]),t._v(" "),e(c.a,[section.section_text?e(o.a,{attrs:{color:"green",elevation:"2",small:""},on:{click:function(e){return t.add_new_tag(section.section_id,section.section_text,section.biog_subject_id,section.biog_subject_name)}}},[t._v("\n             Add")]):t._e()],1),t._v(" "),t._l(section.tag_records,(function(n){return e(f.a,{key:n.tag_id},[e(c.a,{staticClass:"headline"},[e(o.a,{attrs:{large:"",elevation:"2"},on:{click:function(e){return t.load_section(n.tag_id)}}},[t._v("\n             ( "+t._s(n.biog_subject_name)+"-"),e("font",{attrs:{color:"blue"}},[t._v(t._s(n.type_chn))]),t._v("-"+t._s(n.subtype_chn)+"-"),e("font",{attrs:{color:"blue"}},[t._v(t._s(n.content_refined))]),t._v(")\n             ")],1)],1),t._v(" "),e(o.a,{attrs:{color:"error",elevation:"2",small:""},on:{click:function(e){return t.remove_tag(section.section_id,n.tag_id)}}},[t._v("\n             Del")])],1)})),e("br"),e("br"),e(d.a)],2)])})),1)],1)],1)],1)],1),t._v(" "),e(m.a,{attrs:{justify:"center",align:"center"}},[e(l.a,[e(y.a,{attrs:{absolute:t.absolute,opacity:t.opacity,value:t.overlay}},[e(m.a,[e(l.a,{staticClass:"text-center"},[e("h1",{on:{mouseup:t.put_selection_text_to_content}},[t._v(t._s(t.section_text))])])],1),t._v(" "),e(m.a,[e(l.a,[e(c.a,[e(r.a,{attrs:{type:"select",label:"Biographical Subject",outlined:"",dense:"",items:t.person_name_list},on:{click:t.load_subjects_in_section,change:t.select_biog_subject},nativeOn:{input:function(e){t.person_name=e.srcElement.value}},model:{value:t.person_name,callback:function(e){t.person_name=e},expression:"person_name"}})],1)],1),t._v(" "),e(l.a,[e(c.a,[e(k.a,{attrs:{type:"message4",label:"Biographical Subject ID",outlined:"",clearable:"",dense:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.update_person_name_by_cbdb_id.apply(null,arguments)}},model:{value:t.person_id,callback:function(e){t.person_id=e},expression:"person_id"}})],1)],1)],1),t._v(" "),e(m.a,[e(l.a,[e(c.a,[e(v.a,{attrs:{items:t.data_type_list,label:"Data Type",dense:"",solo:""},on:{change:function(e){return t.update_data_type(e)}},model:{value:t.data_type,callback:function(e){t.data_type=e},expression:"data_type"}})],1)],1),t._v(" "),e(l.a,[e(c.a,[e(v.a,{attrs:{items:t.data_subtype_list,label:"Data Subtype",dense:"",solo:""},on:{click:t.get_data_subtype_list_for_select,change:function(e){return t.update_data_subtype(e)}},model:{value:t.data_subtype,callback:function(e){t.data_subtype=e},expression:"data_subtype"}})],1)],1)],1),t._v(" "),e(m.a,[e(l.a,[e(c.a,[e(k.a,{attrs:{type:"message1",label:"Content",outlined:"",clearable:""},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)],1)],1),t._v(" "),e(m.a,[e(l.a,[e(c.a,[e(k.a,{attrs:{type:"message2",label:"Refined Content",outlined:"",clearable:""},model:{value:t.content_refined,callback:function(e){t.content_refined=e},expression:"content_refined"}})],1)],1)],1),t._v(" "),e(m.a,[e(l.a,[e(c.a,[e(r.a,{attrs:{type:"select",label:"Content Person Name",outlined:"",dense:"",items:t.person_name_list},on:{click:t.load_subjects_in_section,change:t.select_content_person},nativeOn:{input:function(e){t.content_person=e.srcElement.value}},model:{value:t.content_person_name,callback:function(e){t.content_person_name=e},expression:"content_person_name"}})],1)],1),t._v(" "),e(l.a,[e(c.a,[e(k.a,{attrs:{type:"message4",label:"Content Person ID",outlined:"",clearable:"",dense:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.update_content_name_by_cbdb_id.apply(null,arguments)}},model:{value:t.content_personid,callback:function(e){t.content_personid=e},expression:"content_personid"}})],1)],1)],1),t._v(" "),e(m.a,{staticClass:"text-center"},[e(l.a,[e(c.a,[e(o.a,{staticClass:"mr-4",attrs:{color:"error"},on:{click:function(e){t.overlay=!1}}},[t._v("\n     Close\n   ")]),t._v(" "),e(o.a,{staticClass:"mr-4",attrs:{color:"primary"},on:{click:t.submit_data}},[t._v("\n     Save\n   ")])],1)],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);